Installation Guide
// Plik uzupe³niony o szczegó³y dotycz¹cej konfiguracji pod systemem Linnux, wszystkie dodane informacje znajduj¹ siê pomiêdzy znacznikami "<!--" i "-->"

1. Recommended requirements:
- Apache version 2.4
- Install apache2:
<!--
	>	$	sudo apt-get install apache2
	Jeœli powy¿szy b³¹d, to:
	>	$	sudo dpkg --configure -a
-->

- PHP 5.6
<!--
- Instalacja PHP aby omin¹æ b³¹d w JIRA
http://askubuntu.com/questions/109404/how-do-i-install-different-upgrade-or-downgrade-php-version-in-still-supported

-	 zainstalowaæ locale-gen i Add the PPA		LC_ALL=en_US.UTF-8 add-apt-repository -y ppa:ondrej/php
	> sudo LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php 			<-	also works.
		"
		# LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php
		More info: https://launchpad.net/~ondrej/+archive/ubuntu/php
		Press [ENTER] to continue or ctrl-c to cancel adding it
		gpg: keyring `/tmp/tmpxpc5qdh2/secring.gpg' created
		gpg: keyring `/tmp/tmpxpc5qdh2/pubring.gpg' created
		gpg: requesting key E5267A6C from hkp server keyserver.ubuntu.com
		gpg: /tmp/tmpxpc5qdh2/trustdb.gpg: trustdb created
		gpg: key E5267A6C: public key "Launchpad PPA for Ondøej Surý" imported
		gpg: Total number processed: 1
		gpg:               imported: 1  (RSA: 1)
		OK
		"
	>	sudo apt-get update
	>	sudo apt-get upgrade
	>	sudo apt-get install php5.6 php5.6-mysql libapache2-mod-php5.6 php5.6-mbstring 
	>	sudo apt-get install php5.6-gettext php5.6-gd 
	>	sudo apt-get install php5.6-xml					<-- wymagany do naprawy - PHP Fatal error:  Call to undefined function simplexml_load_file() in /var/www/testarena.com/library/Zend/Config/Xml.php
	
- sprawdzenie wersji
	>	php -v   
	"
		PHP 5.6.31-1~ubuntu16.04.1+deb.sury.org+1 (cli)
		Copyright (c) 1997-2016 The PHP Group
		Zend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies
		with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies
		marcin1@ubuntutoraid1:~$ "

- Need to restart apache
> sudo /etc/init.d/apache2 restart
or
> sudo service apache2 restart
restart apache OK;

- sprawdzenie instalacji php przez utworzenie pliku 'info.php' i wywo³anie go w przegladarze
	> cd /var/www/html
	> sudo nano info.php
	> <?php	phpinfo()	?>
	> http://192.168.1.xxx/info.php


08. 	Instalacja phpmyadmin
	> 	sudo apt-get install phpmyadmin
	- pytanie o kontynuacje -> T
	- konfiguracja pakiety phpmyadmin
	- Automatycznie przekonfigurowany server WWW -> apache2
	- On config wizard select [*] apache2
  //Konfiguracja pakietu phpmyadmin  
  //Proszê wybraæ serwer WWW, który zostanie automatycznie przekonfigurowany    
  //tak, aby wspó³pracowa³ z phpMyAdmin.                                        
                                                                            
	- Konfiguracja pakietu phpmyadmin 
 The phpmyadmin package must have a database installed and configured        
  before it can be used.  This can be optionally handled with                 
  dbconfig-common.                                                            
                                                                              
  If you are an advanced database administrator and know that you want to     
  perform this configuration manually, or if your database has already        
  been installed and configured, you should refuse this option.  Details      
  on what needs to be done should most likely be provided in                  
  /usr/share/doc/phpmyadmin.                                                  
  Otherwise, you should probably choose this option.                      
 Configure database for phpmyadmin with dbconfig-common?
[TAK]


	- Konfiguracja pakietu phpmyadmin
Please provide a password for administrative account  with which 
this packet should create its MySQL database and user
" ... "[Enter]
Please provide a password for phpmyadmin to register with the database   
  server.  If left blank, a random password will be generated.               
                                                                             
  MySQL application password for phpmyadmin:  
pass: "..."
confirm pass: ....


Konfiguracja pakietu phpmyadmin
if  ERROR 2002 (HY000)     < jeœli b³¹d to znaczy ¿e mysql wy³¹czony


Need to restart apache
	> sudo /etc/init.d/apache2 restart
restart - ok;
	> sudo /etc/init.d/apache2 status
-ok


- Instalacja lynx do sprawdzenia dzia³ania apache2  na serwerze
	> sudo apt-get install lynx
	
- Try to login into 
http://127.0.0.1/phpmyadmin/ 					jeœli brak po³¹czenia z baza - sprawdziæ czy mysql dzia³¹	
	
-->


- MySQL >= 5.5
<!--
06.   instalacja mysql...
I used the following approach:

	>    sudo add-apt-repository 'deb http://archive.ubuntu.com/ubuntu trusty universe'
	>    sudo apt-get update
	>    sudo apt install mysql-server-5.6 mysql-client-5.6
	>  //  sudo apt install mysql-client-5.6

 pytanie o kontynuacje -> T
 Enter new password form MySQL 'root' user
 confirm password	pass: "..."

- Sprawdzenie werji mysql
// mysql --version       - 
			mysql  Ver 14.14 Distrib 5.6.16, for debian-linux-gnu (x86_64) using  EditLine wrapper


- Uruchomienie servera mysql
	> 	#	sudo service mysql status
	> 	#	sudo service mysql start

- Konfiguracja mysql	
	> sudo mysql_secure_installation    		// if   ERROR 2002 (HY000)     < jeœli b³¹d to znaczy ¿e mysql wy³¹czony
	-- change te password? 	-No,
	-- remove anonymous user  -Y, 
	-- disallow root login remotely  -Y
	-- remove 'test' database and access to it   -Y,
	--reload privilages tables now           -Y,

	> mysql --version

- Kopiowania pliku konfiguracyjnego	
	If you're using a version of MySQL earlier than 5.7.6, you should initialize the data directory by running mysql_install_db.
	> sudo mysql_install_db
	Note: In MySQL 5.6, you might get an error that says FATAL ERROR: Could not find my-default.cnf. If you do, copy the /usr/share/my.cnf configuration file into the location that mysql_install_db expects, then rerun it.
	> sudo cp /etc/mysql/my.cnf /usr/share/mysql/my-default.cnf
	
	> sudo mysql_install_db
	This is due to some changes made in MySQL 5.6 and a minor error in the APT package.

- sprawdzenie czy mysql jest uruchomiony
	>	ps -aux | grep mysql
or
	>	service mysql status


- Jeœli nie to uruchom
so to get it working i re-enabled again MySQL server using the command sudo systemctl enable mysql.service and run again the upgrade process and it terminated perfectly.  (http://askubuntu.com/questions/760724/16-04-upgrade-broke-mysql-server?noredirect=1&lq=1)
	>	sudo systemctl enable mysql.service
		"mysql.service is not a native service, redirecting to systemd-sysv-install
		Executing /lib/systemd/systemd-sysv-install enable mysql"

	>	sudo systemctl status mysql.service                    
	? mysql.service - LSB: Start and stop the mysql database server daemon
	Loaded: loaded (/etc/init.d/mysql; bad; vendor preset: enabled)
	Active: inactive (dead)
     Docs: man:systemd-sysv-generator(8)
	 
	>	sudo /etc/init.d/mysql start
	[ ok ] Starting mysql (via systemctl): mysql.service.

- Sprawdzenie czy mysql jest uruchomiony
	>	ps -aux | grep mysql


- Sprawdzenie czy po restarcie mysql siê uruchamia
	> sudo reboot
	> sudo ps -aux | grep mysql	
-->	

Additional non-standard php extensions:
- php_gd2
- php_mbstring

<!--
// na systemach linux podczas instalacji trzeba doinstalowaæ
// sudo apt-get install php5.6 php5.6-mysql php-gettext php5.6-mbstring php5.6-gd php5.6-xml	
-->

Additional apache modules:
- mod_rewrite
<!--
// jeœli w phpinfo() nie ma 'mod_rewrite' to wykonaæ :
	> sudo a2enmod rewrite
-->


2. Installation steps:
2.1. Extract files from the .zip file to an empty directory. Copy all the application files and directories to the directory on the server assigned for TestArena.
<!--
Na serwerze apache tworze katalog 'testarena.com' w '/var/www'
	Do katalogu 'testarena.com' kopiuje ca³¹ zawartoœæ 'testarena'
	Zmieniam w³aœciciela do katalogu
		sudo chown -R www-data:www-data /var/www/testarena.com/public
	Zmodyfikowaæ uprawnienia:
		sudo chmod -R 755 /var/www/testarena.com
	Tworze nowy plik VirtualHost kopiuj¹c plik /etc/apache2/site-available/000-default.conf  do /etc/apache2/site-available/testarena.com.conf 
	Edytuje plik modyfikuj¹c i dopisuj¹c odpowiednio
	    "...
		#ServerName www.example.com
        ServerName testarena.com
        ServerAlias www.testarena.com
        ServerAdmin testarenamaster@testarena.com
        DocumentRoot /var/www/testarena.com/public
        <Directory /var/www/testarena.com/public>
                Options FollowSymLinks
                AllowOverride All
                Require all granted
                Order deny,allow
                Allow from 192.168.1.0/24
        </Directory>
		..."
	W³anczamy VirtualHosta 
		sudo a2ensite testarena.com.conf
		
	Restart lub reload apache2
		sudo service apache2 restart
		sudo service apache2 reload
-->

2.2. Modify the file /application/configs/application.ini applying your personal settings i.e.:
- database
<!--
// sekcja konfiguracji bazy w pliku
;db settings
resources.db.adapter = "PDO_MYSQL"
resources.db.isDefaultTableAdapter = true
resources.db.params.charset = "utf8"

resources.db.params.host = "localhost"
resources.db.params.port = "3306"
resources.db.params.username = "testarena"
resources.db.params.password = "has³o"
resources.db.params.dbname = "testarena"
-->

- mailbox
<!--
// trzeba wykonaæ pe³n¹ konfiguraje w sekcji ';mail settings' uzupe³niaj¹c poprawnie parametry mail.smtp.* - konto musi istanieæ na wskazanym serwerze
;mail settings
mail.phpmailerPath  = _LIBRARY_PATH "/PHPMailer"
mail.charset        = UTF-8
mail.emailFrom      = tester@wp.pl
mail.nameFrom       = TestFromArenaadmin
mail.emailTo        = tester@wp.pl
mail.nameTo         = nameToArenaadmin

mail.smtp.is_smtp    = true
mail.smtp.SMTPSecure = ssl
mail.smtp.Host       = smtp.wp.pl
mail.smtp.Port       = 465
mail.smtp.Sender     = tester@wp.pl
mail.smtp.Username   = tester
mail.smtp.Password   = "password"
-->

- website adress (domain)
<!--
// w sekcji 'site url and cookie domain'
	;site url and cookie domain
	baseUrl = "http://yourdomain"
	cookie_domain = .yourdomain
// jeœli yourdomain jest adresem IP np 192.168.1.118 
// to cookie_domain zapisujemy bez kropki przed adresem  = 192.168.1.118 
// Jeœli utworzyliœmy VHosta dla domeny 'testarena.com' to konfiguracja bêdzie wygl¹daæ
	;site url and cookie domain
	baseUrl = "http://testarena.com"
	cookie_domain = .testarena.com
-->

2.3. Direct a domain assigned in step 2.2 to the directory /public which contains the main index.php file.
2.4. Import the file located at /docs/change_log/testarena_db.sql to the created database.
2.5. Set write permissions for the following directories:
	/public/upload
	/public/captcha
	/logs
	/cache
	/temp
	and their subdirectories.
2.6. Change line 33 in /application/const.php 
	from:
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'development'));
	to
	|| define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : ''));
	
3. Predefined log in data:
	Login: administrator@testarena.pl
	Password: 12qwAS
	
<!--
Na komputerze edytuje plik 'hosts'
		192.168.1.118   testarena.com			# server testowy dla testarena
		192.168.1.118   www.testarena.com		# server testowy dla testarena
Po zapisaniu pliku host uruchamiam strone
		http://testarena.com/
-->	
		
		
	

<--		////////////////////////////////////////   Opis instalacji od strony servera 	////////////////////////////////////////
	Stworzymy VirtualHost dla 'testarena.com'
	Na serwerze apache tworze katalog 'testarena.com' w '/var/www'
	Do katalogu testarena.com kopiuje ca³¹ zawartoœæ 'testarena'
	Zmieniam w³aœciciela do katalogu
		sudo chown -R www-data:www-data /var/www/testarena.com/public
	I tak samo dla pozosta³ych katalogów wymagaj¹cych uprawnieñ do zapisu
	/logs
	/cache
	/temp
		sudo chown -R www-data:www-data /var/www/testarena.com/logs
		sudo chown -R www-data:www-data /var/www/testarena.com/cache
		sudo chown -R www-data:www-data /var/www/testarena.com/temp
	A najlepiej dla ca³oœci
		/var/www$ sudo chown -R www-data:www-data testarena.com/

	Zmodyfikowaæ uprawnienia:
		sudo chmod -R 755 /var/www/testarena.com
	Tworze nowy plik VirtualHost kopiuj¹c plik /etc/apache2/site-available/000-default.conf  do /etc/apache2/site-available/testarena.com.conf 
	Edytuje plik modyfikuj¹c i dopisuj¹c odpowiednio
	    "...
		#ServerName www.example.com
        ServerName testarena.com
        ServerAlias www.testarena.com
        ServerAdmin testarenamaster@testarena.com
        DocumentRoot /var/www/testarena.com/public
        <Directory /var/www/testarena.com/public>
                Options FollowSymLinks
                AllowOverride All
                Require all granted
                Order deny,allow
                Allow from 192.168.1.0/24
        </Directory>
		..."
	Restart apache
		sudo service apache2 restart
	
	Na komputerze edytuje plik 'hosts'
		192.168.1.118   testarena.com			# server testowy dla testarena
		192.168.1.118   www.testarena.com		# server testowy dla testarena
	Po zapisaniu pliku host uruchamiam strone
		http://testarena.com/
		
-->	


<!--
jeœli jest b³¹d 500 na stronie , a w pliku /var/www/testarena.com/cache/application-logs/php-error.log
[25-Aug-2017 14:56:44 Europe/Warsaw] PHP Fatal error:  Call to undefined function simplexml_load_file() in /var/www/testarena.com/library/Zend/Config/Xml.php on li$
to aby rozwi¹zaæ problem dointaluje modu³ xml.
	> sudo apt-get install php5.6-xml
Restart apache 
	>	sudo service apache2 restart
		
-->